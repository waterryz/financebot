<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–ì–ª–∞–≤–Ω–∞—è</title>
    <link rel="stylesheet" href="/static/style.css">
    <script>
        function toggleSidebar() {
            document.getElementById("sidebar").classList.toggle("open");
        }
    </script>
</head>
<div class="top-profile">
    <div class="profile-icon" onclick="toggleProfileMenu()">üë§</div>

    <div class="profile-menu" id="profileMenu">
        <a href="/profile?token={{ token }}">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
        <a href="/settings?token={{ token }}">‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
        <a href="/login">üö™ –í—ã–π—Ç–∏</a>
    </div>
</div>

<script>
function toggleProfileMenu() {
    document.getElementById("profileMenu").classList.toggle("open");
}
</script>

<body>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar">
    <div class="sidebar-tab" onclick="toggleSidebar()">‚ò∞</div>

    <div class="sidebar-content">
        <a href="/home?token={{ token }}">üè† –ì–ª–∞–≤–Ω–∞—è</a>
        <a href="/add_expense?token={{ token }}">‚ûñ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</a>
        <a href="/add_income?token={{ token }}">‚ûï –î–æ–±–∞–≤–∏—Ç—å –¥–æ—Ö–æ–¥</a>
        <a href="/history?token={{ token }}">üìú –ò—Å—Ç–æ—Ä–∏—è</a>
        <a href="/goals?token={{ token }}">üéØ –¶–µ–ª–∏</a>

        <a href="/wishlist?token={{ token }}">üïí –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏</a>
        <a href="/stats?token={{ token }}">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>

    </div>
</div>

<!-- MAIN CARD -->
<div class="auth-card">
    <h1>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {{ username }}!</h1>
    <p style="font-size:18px;">–í–∞—à —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å:</p>

    <div class="balance-box">
        <span>{{ balance }} ‚Ç∏</span>
    </div>

    <div class="home-buttons">
        <a href="/add_expense?token={{ token }}" class="home-btn red">‚ûñ –†–∞—Å—Ö–æ–¥</a>
        <a href="/add_income?token={{ token }}" class="home-btn green">‚ûï –î–æ—Ö–æ–¥</a>
        <a href="/history?token={{ token }}" class="home-btn blue">üìú –ò—Å—Ç–æ—Ä–∏—è</a>
    </div>
</div>

<!-- EXTRA BLOCKS -->
<div class="home-extra">

    <!-- 1. –ò—Ç–æ–≥–∏ –º–µ—Å—è—Ü–∞ -->
    <div class="extra-card">
        <h3>üìÖ –ò—Ç–æ–≥–∏ –º–µ—Å—è—Ü–∞</h3>
        <p><b>–î–æ—Ö–æ–¥:</b> {{ month_income }} ‚Ç∏</p>
        <p><b>–†–∞—Å—Ö–æ–¥:</b> {{ month_expense }} ‚Ç∏</p>
        <p><b>–ë–∞–ª–∞–Ω—Å:</b> {{ month_balance }} ‚Ç∏</p>
    </div>

    <!-- 2. –¢–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
    <div class="extra-card">
        <h3>üî• –¢–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ —Ä–∞—Å—Ö–æ–¥–∞–º</h3>
        {% if top_categories %}
            {% for cat, amount in top_categories %}
                <p><b>{{ cat }}</b> ‚Äî {{ amount }} ‚Ç∏</p>
            {% endfor %}
        {% else %}
            <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p>
        {% endif %}
    </div>

    <!-- 3. –ü–æ—Å–ª–µ–¥–Ω—è—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è -->
    <div class="extra-card">
        <h3>üìå –ü–æ—Å–ª–µ–¥–Ω—è—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è</h3>
        {% if last_transaction %}
            <p><b>{{ last_transaction.category }}</b></p>
            <p>{{ last_transaction.description }}</p>
            <p>{{ last_transaction.amount }} ‚Ç∏</p>
            <p class="extra-date">{{ last_transaction.date }}</p>
        {% else %}
            <p>–ü–æ–∫–∞ –ø—É—Å—Ç–æ</p>
        {% endif %}
    </div>

    <!-- 4. –¶–µ–ª—å / –ü—Ä–æ–≥—Ä–µ—Å—Å -->
    <div class="extra-card">
        <h3>üéØ –¶–µ–ª—å</h3>

        {% if goal %}
            <p><b>{{ goal.name }}</b></p>
            <p>{{ goal.saved }} / {{ goal.target }} ‚Ç∏</p>

            <div class="progress-bar">
                <div class="progress-fill" style="width: {{ goal.percent }}%;"></div>
            </div>

        {% else %}
            <p>–¶–µ–ª—å –Ω–µ –∑–∞–¥–∞–Ω–∞</p>

            <div class="goal-add-wrapper">
                <a href="/add_goal?token={{ token }}" class="goal-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</a>
            </div>

        {% endif %}
    </div>

</div>

</body>
</html>
