{% extends "admin_layout.html" %}

{% block content %}

<h1 class="text-4xl font-bold mb-10">üìä –ê–¥–º–∏–Ω ‚Äî –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>

<div class="grid md:grid-cols-4 gap-6">

    <div class="bg-slate-900/70 p-6 rounded-2xl border border-white/10 shadow-lg">
        <p class="text-slate-400 text-sm">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
        <p class="text-4xl font-bold">{{ stats.total_users }}</p>
    </div>

    <div class="bg-slate-900/70 p-6 rounded-2xl border border-white/10 shadow-lg">
        <p class="text-slate-400 text-sm">–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</p>
        <p class="text-4xl font-bold">{{ stats.total_transactions }}</p>
    </div>

    <div class="bg-slate-900/70 p-6 rounded-2xl border border-white/10 shadow-lg">
        <p class="text-slate-400 text-sm">–î–æ—Ö–æ–¥—ã</p>
        <p class="text-3xl text-emerald-400 font-semibold">{{ stats.total_income }} ‚Ç∏</p>
    </div>

    <div class="bg-slate-900/70 p-6 rounded-2xl border border-white/10 shadow-lg">
        <p class="text-slate-400 text-sm">–†–∞—Å—Ö–æ–¥—ã</p>
        <p class="text-3xl text-rose-400 font-semibold">{{ stats.total_expenses }} ‚Ç∏</p>
    </div>

</div>

<div class="grid md:grid-cols-2 gap-6 mt-10">

    <div class="bg-slate-900/70 p-6 rounded-2xl border border-white/10 shadow-xl">
        <h2 class="text-xl font-semibold mb-4">–î–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</h2>
        <canvas id="moneyChart" height="180"></canvas>
    </div>

    <div class="bg-slate-900/70 p-6 rounded-2xl border border-white/10 shadow-xl">
        <h2 class="text-xl font-semibold mb-4">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
        <canvas id="activityChart" height="180"></canvas>
    </div>

</div>

<div class="mt-10 bg-slate-900/70 p-6 rounded-2xl border border-white/10 shadow-xl">
    <h2 class="text-xl font-semibold mb-4">–¢–æ–ø 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤</h2>
    <canvas id="topCategoriesChart" height="150"></canvas>
</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const weekLabels = {{ week_labels | tojson }};
const incomeData = {{ income_data | tojson }};
const expenseData = {{ expense_data | tojson }};

new Chart(document.getElementById("moneyChart"), {
    type: "line",
    data: {
        labels: weekLabels,
        datasets: [
            {
                label: "–î–æ—Ö–æ–¥—ã",
                borderColor: "#4ade80",
                backgroundColor: "#4ade8050",
                data: incomeData,
                tension: .4
            },
            {
                label: "–†–∞—Å—Ö–æ–¥—ã",
                borderColor: "#f87171",
                backgroundColor: "#f8717150",
                data: expenseData,
                tension: .4
            }
        ]
    }
});


const actLabels = {{ activity_labels | tojson }};
const actData = {{ activity_data | tojson }};

new Chart(document.getElementById("activityChart"), {
    type: "bar",
    data: {
        labels: actLabels,
        datasets: [{
            label: "–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
            backgroundColor: "#60a5faaa",
            data: actData
        }]
    }
});


const topLabels = {{ top_cat_labels | tojson }};
const topValues = {{ top_cat_values | tojson }};

new Chart(document.getElementById("topCategoriesChart"), {
    type: "pie",
    data: {
        labels: topLabels,
        datasets: [{
            backgroundColor: ["#4ade80", "#60a5fa", "#a78bfa", "#fbbf24", "#f87171"],
            data: topValues
        }]
    }
});
</script>

{% endblock %}
